<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.Font?>

<BorderPane prefHeight="600.0" prefWidth="900.0" xmlns="http://javafx.com/javafx/17" xmlns:fx="http://javafx.com/fxml/1" fx:controller="HABMS.client.controller.DoctorMainController">
    <top>
        <HBox alignment="CENTER_LEFT" spacing="20" style="-fx-background-color: #2c3e50; -fx-padding: 15;">
            <Label text="飞马医院 - 医生/管理端" textFill="WHITE">
                <font>
                    <Font size="20.0" />
                </font>
            </Label>
            <Region HBox.hgrow="ALWAYS" />
            <Label fx:id="welcomeLabel" text="欢迎, 医生" textFill="WHITE" />
            <Button onAction="#handleLogout" text="退出登录" />
        </HBox>
    </top>
    <center>
        <TabPane fx:id="mainTabPane" tabClosingPolicy="UNAVAILABLE">
            <tabs>
                <Tab text="我的排班">
                    <VBox spacing="10" style="-fx-padding: 20;">
                        <HBox alignment="CENTER_LEFT" spacing="10">
                            <Label text="我的排班表">
                                <font><Font size="18.0" /></font>
                            </Label>
                            <Button onAction="#handleRefreshSchedules" text="刷新" />
                        </HBox>
                        <TableView fx:id="scheduleTable" VBox.vgrow="ALWAYS">
                            <columns>
                                <TableColumn fx:id="colSchId" text="排班ID" />
                                <TableColumn fx:id="colSchStart" text="开始时间" prefWidth="150"/>
                                <TableColumn fx:id="colSchEnd" text="结束时间" prefWidth="150"/>
                                <TableColumn fx:id="colSchCap" text="总号源" />
                                <TableColumn fx:id="colSchRes" text="剩余号源" />
                            </columns>
                        </TableView>
                    </VBox>
                </Tab>
                <Tab text="叫号诊疗">
                    <VBox spacing="10" style="-fx-padding: 20;">
                        <HBox alignment="CENTER_LEFT" spacing="10">
                            <Label text="当前候诊列表">
                                <font><Font size="18.0" /></font>
                            </Label>
                            <ComboBox fx:id="workScheduleCombo" promptText="选择当前排班" prefWidth="200"/>
                            <Button onAction="#handleRefreshAppointments" text="刷新列表" />
                            <Region HBox.hgrow="ALWAYS" />
                            <Button onAction="#handleCallNext" style="-fx-background-color: #27ae60; -fx-text-fill: white;" text="呼叫下一位" />
                        </HBox>
                        <TableView fx:id="appointmentTable" VBox.vgrow="ALWAYS">
                            <columns>
                                <TableColumn fx:id="colAppId" text="预约号" />
                                <TableColumn fx:id="colAppPid" text="患者ID" />
                                <TableColumn fx:id="colAppTime" text="预约时间" prefWidth="150"/>
                                <TableColumn fx:id="colAppStatus" text="状态" />
                            </columns>
                        </TableView>
                        <TextArea fx:id="diagnosisArea" promptText="诊疗记录/备注..." VBox.vgrow="ALWAYS" />
                        <Button text="完成诊疗" onAction="#handleCompleteDiagnosis" maxWidth="Infinity"/>
                    </VBox>
                </Tab>
                <Tab fx:id="managementTab" text="医院管理">
                    <VBox spacing="20" style="-fx-padding: 30;">
                        <Label text="医院管理功能 (仅管理员可见)">
                            <font><Font size="18.0" /></font>
                        </Label>
                        
                        <TitledPane text="批量导入" collapsible="false">
                            <VBox spacing="10">
                                <Label text="导入医生信息和排班表 (Excel .xls)" />
                                <HBox spacing="10">
                                    <Button text="选择文件..." onAction="#handleSelectImportFile"/>
                                    <Label fx:id="importFileLabel" text="未选择文件"/>
                                </HBox>
                                <Button text="开始导入" onAction="#handleImportData"/>
                            </VBox>
                        </TitledPane>
                        
                        <TitledPane text="数据导出" collapsible="false">
                            <VBox spacing="10">
                                <Label text="导出预约记录为 Excel 文件" />
                                <Button text="导出预约记录" onAction="#handleExportAppointments"/>
                            </VBox>
                        </TitledPane>
                        
                        <TitledPane text="统计报告" collapsible="false">
                            <VBox spacing="10">
                                <Label text="生成月度统计报告 (PDF)" />
                                <Button text="生成报告" onAction="#handleGenerateReport"/>
                            </VBox>
                        </TitledPane>
                    </VBox>
                </Tab>
                <Tab text="个人信息">
                    <VBox spacing="15" style="-fx-padding: 30;">
                        <GridPane hgap="10" vgap="10">
                            <Label text="医生ID:" GridPane.columnIndex="0" GridPane.rowIndex="0" />
                            <TextField fx:id="profileDid" editable="false" GridPane.columnIndex="1" GridPane.rowIndex="0" />
                            
                            <Label text="姓名:" GridPane.columnIndex="0" GridPane.rowIndex="1" />
                            <TextField fx:id="profileName" editable="false" GridPane.columnIndex="1" GridPane.rowIndex="1" />
                            
                            <Label text="科室:" GridPane.columnIndex="0" GridPane.rowIndex="2" />
                            <TextField fx:id="profileDept" editable="false" GridPane.columnIndex="1" GridPane.rowIndex="2" />
                            
                            <Label text="专长:" GridPane.columnIndex="0" GridPane.rowIndex="3" />
                            <TextArea fx:id="profileDesc" editable="false" prefRowCount="3" GridPane.columnIndex="1" GridPane.rowIndex="3" />
                            
                            <Label text="管理员权限:" GridPane.columnIndex="0" GridPane.rowIndex="4" />
                            <CheckBox fx:id="profileAdmin" disable="true" GridPane.columnIndex="1" GridPane.rowIndex="4" />
                        </GridPane>
                    </VBox>
                </Tab>
            </tabs>
        </TabPane>
    </center>
</BorderPane>
